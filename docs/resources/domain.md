---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "libvirt_domain Resource - terraform-provider-libvirt"
subcategory: ""
description: |-
  Manages a libvirt domain (virtual machine).
  This resource follows the libvirt domain XML schema https://libvirt.org/formatdomain.html closely,
  providing fine-grained control over VM configuration.
---

# libvirt_domain (Resource)

Manages a libvirt domain (virtual machine).

This resource follows the [libvirt domain XML schema](https://libvirt.org/formatdomain.html) closely,
providing fine-grained control over VM configuration.

## Example Usage

```terraform
# Basic VM configuration
resource "libvirt_domain" "example" {
  name   = "example-vm"
  memory = 2048
  unit   = "MiB"
  vcpu   = 2
  type   = "kvm"

  os {
    type    = "hvm"
    arch    = "x86_64"
    machine = "q35"
    boot_devices = ["hd", "network"]
  }

  # TODO: Add device configuration once implemented
  # - disks
  # - network interfaces
  # - graphics
}

# VM with UEFI firmware
resource "libvirt_domain" "uefi_example" {
  name   = "uefi-vm"
  memory = 4096
  unit   = "MiB"
  vcpu   = 4
  type   = "kvm"

  os {
    type        = "hvm"
    arch        = "x86_64"
    machine     = "q35"
    firmware    = "efi"
    loader_path = "/usr/share/edk2/x64/OVMF_CODE.secboot.4m.fd"
    loader_readonly = true
    loader_type     = "pflash"
    nvram_path      = "/usr/share/edk2/x64/OVMF_VARS.4m.fd"
    boot_devices    = ["hd"]
  }
}

# VM with direct kernel boot
resource "libvirt_domain" "kernel_boot" {
  name   = "kernel-boot-vm"
  memory = 1024
  unit   = "MiB"
  vcpu   = 1
  type   = "kvm"

  os {
    type        = "hvm"
    arch        = "x86_64"
    kernel      = "/boot/vmlinuz"
    initrd      = "/boot/initrd.img"
    kernel_args = "console=ttyS0 root=/dev/vda1"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `memory` (Number) Maximum memory allocation in the specified unit. Default unit is KiB.
- `name` (String) Domain name. Must be unique on the host.
- `vcpu` (Number) Number of virtual CPUs.

### Optional

- `bootloader` (String) Bootloader path for paravirtualized guests (Xen).
- `bootloader_args` (String) Arguments to pass to bootloader.
- `clock` (Block, Optional) Clock configuration for the domain. (see [below for nested schema](#nestedblock--clock))
- `cpu` (Block, Optional) CPU configuration for the domain. (see [below for nested schema](#nestedblock--cpu))
- `current_memory` (Number) Actual memory allocation at boot time. If not set, defaults to memory value.
- `description` (String) Human-readable description of the domain.
- `disk` (Block List) Disk devices attached to the domain. (see [below for nested schema](#nestedblock--disk))
- `features` (Block, Optional) Hypervisor features to enable. (see [below for nested schema](#nestedblock--features))
- `hwuuid` (String) Hardware UUID for the domain.
- `interface` (Block List) Network interfaces attached to the domain. (see [below for nested schema](#nestedblock--interface))
- `iothreads` (Number) Number of I/O threads for virtio disks.
- `max_memory` (Number) Maximum memory for hotplug. Must be >= memory.
- `max_memory_slots` (Number) Number of slots for memory hotplug. Required when max_memory is set.
- `on_crash` (String) Action to take when guest crashes (destroy, restart, preserve, rename-restart, coredump-destroy, coredump-restart).
- `on_poweroff` (String) Action to take when guest requests poweroff (destroy, restart, preserve, rename-restart).
- `on_reboot` (String) Action to take when guest requests reboot (destroy, restart, preserve, rename-restart).
- `os` (Block, Optional) Operating system configuration. See [libvirt OS element documentation](https://libvirt.org/formatdomain.html#operating-system-booting). (see [below for nested schema](#nestedblock--os))
- `pm` (Block, Optional) Power management configuration for the domain. (see [below for nested schema](#nestedblock--pm))
- `title` (String) Short description title for the domain.
- `type` (String) Domain type (e.g., 'kvm', 'qemu'). Defaults to 'kvm'.
- `unit` (String) Memory unit (KiB, MiB, GiB, TiB). Defaults to KiB if not specified.
- `uuid` (String) Domain UUID. If not specified, one will be generated.

### Read-Only

- `id` (String) Domain identifier (UUID)

<a id="nestedblock--clock"></a>
### Nested Schema for `clock`

Optional:

- `adjustment` (String) Clock adjustment in seconds.
- `basis` (String) Clock basis (utc, localtime).
- `offset` (String) Clock offset (utc, localtime, timezone, variable).
- `timer` (Block List) Timer devices for the guest clock. (see [below for nested schema](#nestedblock--clock--timer))
- `timezone` (String) Timezone name when offset is 'timezone'.

<a id="nestedblock--clock--timer"></a>
### Nested Schema for `clock.timer`

Required:

- `name` (String) Timer name (platform, pit, rtc, hpet, tsc, kvmclock, hypervclock, armvtimer).

Optional:

- `catchup` (Block, Optional) Timer catchup configuration. (see [below for nested schema](#nestedblock--clock--timer--catchup))
- `frequency` (Number) Timer frequency in Hz.
- `mode` (String) Timer mode (auto, native, emulate, paravirt, smpsafe).
- `present` (String) Whether timer is present (yes, no).
- `tickpolicy` (String) Tick policy (delay, catchup, merge, discard).
- `track` (String) Track source (guest, wall).

<a id="nestedblock--clock--timer--catchup"></a>
### Nested Schema for `clock.timer.catchup`

Optional:

- `limit` (Number) Limit in nanoseconds.
- `slew` (Number) Slew in nanoseconds.
- `threshold` (Number) Threshold in nanoseconds.




<a id="nestedblock--cpu"></a>
### Nested Schema for `cpu`

Optional:

- `check` (String) CPU check policy (none, partial, full).
- `deprecated_features` (String) How to handle deprecated features (allow, forbid).
- `match` (String) CPU match policy (exact, minimum, strict).
- `migratable` (String) Whether the CPU is migratable (on, off).
- `mode` (String) CPU mode (host-model, host-passthrough, custom).
- `model` (String) CPU model name.
- `vendor` (String) CPU vendor.


<a id="nestedblock--disk"></a>
### Nested Schema for `disk`

Required:

- `target` (String) Target device name (e.g., vda, sda, hda).

Optional:

- `bus` (String) Bus type (virtio, scsi, ide, sata, usb).
- `device` (String) Device type (disk, cdrom, floppy, lun).
- `source` (String) Path to the disk image file.


<a id="nestedblock--features"></a>
### Nested Schema for `features`

Optional:

- `acpi` (Boolean) ACPI support.
- `apic` (Boolean) APIC support.
- `ccf_assist` (String) CCF Assist (on, off).
- `gic_version` (String) GIC version for ARM guests.
- `hap` (String) Hardware Assisted Paging (on, off).
- `htm` (String) Hardware Transactional Memory (on, off).
- `ioapic_driver` (String) IOAPIC driver (kvm, qemu).
- `nested_hv` (String) Nested HV (on, off).
- `pae` (Boolean) Physical Address Extension mode.
- `pmu` (String) Performance Monitoring Unit (on, off).
- `privnet` (Boolean) Private network namespace.
- `ps2` (String) PS/2 controller (on, off).
- `pvspinlock` (String) Paravirtualized spinlock prevention (on, off).
- `ras` (String) Reliability, Availability and Serviceability (on, off).
- `viridian` (Boolean) Viridian enlightenments for Windows guests.
- `vmcoreinfo` (String) VM crash information (on, off).
- `vmport` (String) VMware IO port emulation (on, off, auto).


<a id="nestedblock--interface"></a>
### Nested Schema for `interface`

Required:

- `type` (String) Interface type (network, bridge, user, direct, etc.).

Optional:

- `mac` (String) MAC address for the interface.
- `model` (String) Device model (virtio, e1000, rtl8139, etc.).
- `source` (Block, Optional) Interface source configuration. (see [below for nested schema](#nestedblock--interface--source))

<a id="nestedblock--interface--source"></a>
### Nested Schema for `interface.source`

Optional:

- `bridge` (String) Bridge name (for type=bridge).
- `dev` (String) Device name (for type=user or type=direct).
- `network` (String) Network name (for type=network).
- `portgroup` (String) Port group name (for type=network).



<a id="nestedblock--os"></a>
### Nested Schema for `os`

Required:

- `type` (String) OS type (e.g., 'hvm' for fully virtualized, 'linux' for paravirtualized). Required.

Optional:

- `arch` (String) CPU architecture (e.g., 'x86_64', 'aarch64'). Optional.
- `boot_devices` (List of String) Ordered list of boot devices (e.g., 'hd', 'network', 'cdrom'). Optional. If not specified, libvirt may add default boot devices.
- `firmware` (String) Firmware type (e.g., 'efi', 'bios'). Optional.
- `initrd` (String) Path to initrd image for direct kernel boot. Optional.
- `kernel` (String) Path to kernel image for direct kernel boot. Optional.
- `kernel_args` (String) Kernel command line arguments. Optional.
- `loader_path` (String) Path to UEFI firmware loader. Optional.
- `loader_readonly` (Boolean) Whether the UEFI firmware is read-only. Optional.
- `loader_type` (String) Loader type ('rom' or 'pflash'). Optional.
- `machine` (String) Machine type (e.g., 'pc', 'q35'). Optional. Note: This value represents what you want, but libvirt may internally expand it to a versioned type.
- `nvram_path` (String) Path to NVRAM template for UEFI. Optional.


<a id="nestedblock--pm"></a>
### Nested Schema for `pm`

Optional:

- `suspend_to_disk` (String) Suspend to disk policy (yes, no).
- `suspend_to_mem` (String) Suspend to memory policy (yes, no).
